base_image: quay.io/almalinuxorg/9-base:9.5

prepare:
  copy_files:
    - src: ./input.yaml
      dest: /root/input.yaml
  commands:
    - echo "initial setup" > /root/init
    - echo tmp > /tmp/test

main_operation:
  commands:
    - echo test >> /root/input.yaml
    - mkdir /root/test
    - echo test > /root/test/tmp
    - dnf -y install tigervnc-license

target_dirs: [/etc, /var, /root, /tmp]
exclude_paths:
  - /var/cache/dnf
  - /var/lib/dnf
  - /var/lib/rpm
  - /var/log
omit_diff_paths:
  - /var/log/dnf.log

command_diff:
  - command: "rpm -qa | sort"
    outfile: "pkglist.txt"
